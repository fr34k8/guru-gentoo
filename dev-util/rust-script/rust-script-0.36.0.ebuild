# Copyright 2024-2025 Gentoo Authors
# Distributed under the terms of the GNU General Public License v2

# Autogenerated by pycargoebuild 0.13.3

EAPI=8

CRATES="
"

RUST_MIN_VER="1.74.1"

inherit cargo

DESCRIPTION="Command-line tool to run Rust scripts which can make use of crates"
HOMEPAGE="https://rust-script.org"
SRC_URI="
	https://github.com/fornwall/rust-script/archive/refs/tags/${PV}.tar.gz -> ${P}.tar.gz
	https://github.com/pastalian/distfiles/releases/download/${P}/${P}-crates.tar.xz
"

LICENSE="|| ( Apache-2.0 MIT )"
# Dependent crate licenses
LICENSE+=" MIT MPL-2.0 Unicode-3.0"
SLOT="0"
KEYWORDS="~amd64"

QA_FLAGS_IGNORED="usr/bin/.*"

PATCHES=(
	# tests does not work with CARGO_BUILD_TARGET defined
	"${FILESDIR}/${PN}-0.34.0-fix-test.patch"
)

src_prepare() {
	default
	sed -i "s|\"target\"|\"$(cargo_target_dir)\"|" tests/util/mod.rs || die
}
